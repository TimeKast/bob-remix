# 2.0 üìë Crear Documentaci√≥n (Funcional + T√©cnica)

> **Input**: `/docs/Propuesta.md` (salida de 1.1)
> **Output**: `/docs/*` (documentaci√≥n completa)
> **Siguiente**: `2.1_Backlog.md`

Act√∫a como **Project Architect & Senior Technical Writer**.

## Est√°ndares obligatorios

- Todo debe cumplir `/.agent/rules/00_global.mdc`:
  - claridad, consistencia, supuestos expl√≠citos, cero relleno, estructura mantenible.

## Fuente principal de verdad (input)

- `/docs/Propuesta.md` (Documento de Propuesta validado por el cliente) es la fuente principal de verdad.

## Stack objetivo (fijo)

- Frontend: Next.js (App Router) + TypeScript
- Backend: TypeScript
- DB/ORM: Drizzle ORM

---

## üë• Agente(s) sugeridos (OBLIGATORIO)

Usa como gu√≠a:

- `/.agent/agents/project-architect.md`
- `/.agent/agents/technical-writer.md`
- `/.agent/agents/solution-architect-technical.md` _(enfoque t√©cnico con este stack)_

> Si faltan estos archivos, crea placeholders m√≠nimos en `/agents` (rol + checklist + estilo) y contin√∫a.

---

## ‚ö†Ô∏è REGLA CR√çTICA ‚Äî Documentaci√≥n a consultar (m√≠nima)

Para ahorrar tokens y mantener contexto preciso, al inicio de CADA entrega incluye:

### Documentaci√≥n a consultar (m√≠nima)

- `/docs/Propuesta.md` ‚Äî Secci√≥n: "<t√≠tulo exacto>"
- `1.0_Discovery.md` ‚Äî Secci√≥n: "B4 Salida estructurada (YAML)" _(si aplica)_
- Otros docs existentes (solo si ya existen) ‚Äî secci√≥n exacta

M√°ximo 3‚Äì6 bullets. Sin copiar contenido.

---

## üéØ Objetivo

Generar documentaci√≥n funcional y t√©cnica completa, lista para:

- Desarrollo
- QA
- Planeaci√≥n
- Creaci√≥n de backlog (GitHub)

---

## ‚úÖ Reglas clave

- NO vuelvas a hacer discovery con el cliente.
- NO repitas preguntas de objetivos o visi√≥n.
- Usa `/docs/Propuesta.md` como base.
- Si falta informaci√≥n:
  - Haz suposiciones razonables.
  - Decl√°ralas expl√≠citamente en ‚ÄúSupuestos‚Äù.
  - Solo pregunta si algo es realmente bloqueante (m√°ximo 5).

---

## üìÅ Estructura de archivos obligatoria (salida en /docs)

Crea/actualiza estos archivos dentro de `/docs`:

### Funcional / Producto

- `/docs/00_overview.md` (Resumen ejecutivo + alcance/no alcance + √©xito)
- `/docs/01_personas.md`
- `/docs/02_flows.md`
- `/docs/03_user_stories.md`
- `/docs/04_business_rules.md`
- `/docs/05_permissions_rbac.md`
- `/docs/06_glossary.md`

### T√©cnico

- `/docs/10_architecture.md`
- `/docs/11_data_model.md`
- `/docs/12_api_contracts.md`
- `/docs/13_auth_security.md`
- `/docs/14_errors_observability.md`
- `/docs/15_deployment_ops.md`
- `/docs/16_design_system.md` (tokens, temas, componentes, guidelines)
- `/docs/17_pwa.md` (manifest, service worker, caching, offline, installability)
- `/docs/18_environment.md` (variables de entorno, servicios externos, setup)

### Calidad / Operaci√≥n / Roadmap

- `/docs/20_quality_qa.md`
- `/docs/21_definition_of_ready_done.md`
- `/docs/22_runbooks.md`
- `/docs/23_roadmap.md`
- `/docs/24_risks_assumptions.md`

Reglas:

- No dupliques informaci√≥n entre archivos: referencia secciones.
- Mant√©n t√≠tulos consistentes y enlaces internos cuando sea √∫til.

---

# üß© Fases y entregas (NO entregar todo en una sola respuesta)

## Fase 0 ‚Äî Revisi√≥n de insumos (OBLIGATORIA)

Antes de documentar:

1. Revisa `1.2_Propuesta.md`.
2. Identifica:
   - Qu√© ya est√° claramente definido
   - Qu√© debe inferirse
   - Qu√© podr√≠a ser ambiguo

Entrega SOLO:

- **‚ÄúSupuestos y decisiones tomadas‚Äù**
- **‚ÄúPreguntas bloqueantes (si existen)‚Äù** (m√°ximo 5)

‚ùó No generes documentaci√≥n a√∫n.

---

## Fase 1 ‚Äî Documentaci√≥n funcional y de producto (entregas parciales)

Genera en entregas ordenadas, creando/actualizando archivos:

1. `/docs/00_overview.md`
   - Resumen Ejecutivo
   - Alcance / No Alcance
   - Criterios de √©xito / m√©tricas
   - Criterios de aceptaci√≥n globales

2. `/docs/01_personas.md`
   - User Personas (2‚Äì6)
   - Objetivos por persona
   - Fricciones / dolores

3. `/docs/02_flows.md`
   - Flujo principal end-to-end
   - Flujos secundarios
   - Estados clave y ‚Äúproceso completado‚Äù
   - Validaciones y estados de UI (alto nivel)

4. `/docs/03_user_stories.md`
   - Historias como: ‚ÄúComo [rol] quiero [acci√≥n] para [beneficio]‚Äù
   - Criterios de aceptaci√≥n en Given/When/Then
   - Agrupaci√≥n por m√≥dulo/flujo

5. `/docs/04_business_rules.md`
   - Reglas de negocio
   - Validaciones
   - Estados y transiciones
   - Casos l√≠mite importantes

6. `/docs/05_permissions_rbac.md`
   - Matriz RBAC (tabla)
   - Capacidades por rol
   - Restricciones relevantes

7. `/docs/06_glossary.md`
   - Glosario de t√©rminos (15‚Äì50)

---

## Fase 2 ‚Äî Arquitectura y documentaci√≥n t√©cnica (accionable)

Documenta con claridad y sin relleno:

1. `/docs/10_architecture.md`
   - Arquitectura t√©cnica (Next.js App Router + TS + Drizzle)
   - Server Components vs Client Components
   - Route Handlers / Server Actions (si aplica)
   - Caching / revalidation / SSR / ISR / CSR (decisiones)
   - Estrategia de manejo de errores (alto nivel)

2. `/docs/11_data_model.md`
   - Entidades y relaciones
   - Reglas de integridad
   - Estrategia de migraciones (Drizzle)
   - Campos sensibles / auditor√≠a (si aplica)

3. `/docs/12_api_contracts.md`
   - Contratos de API (internos/externos)
   - Inputs/outputs esperados (ejemplos cortos)
   - Errores esperados (c√≥digos y mensajes)

4. `/docs/13_auth_security.md`
   - Estrategia auth (login/session)
   - Autorizaci√≥n (RBAC)
   - Seguridad b√°sica (validaci√≥n, rate limit si aplica, protecci√≥n datos)
   - Variables de entorno (solo listado + prop√≥sito, sin secretos)

5. `/docs/14_errors_observability.md`
   - Logging (qu√© se loguea y qu√© no)
   - M√©tricas m√≠nimas
   - Trazabilidad de errores

6. `/docs/15_deployment_ops.md`
   - Estrategia de despliegue
   - Backups y recuperaci√≥n
   - Entornos (dev/stage/prod) y configuraci√≥n

---

## Fase 3 ‚Äî Calidad, operaci√≥n y roadmap

Incluye:

1. `/docs/20_quality_qa.md`
   - NFRs (performance, seguridad, disponibilidad, etc.)
   - Plan de testing: unit / integration / e2e
   - Estrategia QA

2. `/docs/21_definition_of_ready_done.md`
   - DoR / DoD (bullet list claro)
   - Reglas para aceptar PRs (si aplica)

3. `/docs/22_runbooks.md`
   - Runbooks operativos (incidentes comunes)
   - Checklist de release

4. `/docs/23_roadmap.md`
   - MVP / V1 / V2 (qu√© entra y qu√© no)
   - Supuestos

5. `/docs/24_risks_assumptions.md`
   - Riesgos
   - Supuestos
   - Mitigaciones

---

## üõë Reglas finales de entrega (anti-token-waste)

- NO entregues todo en una sola respuesta.
- Divide en entregas numeradas y ordenadas.
- Cada entrega debe decir:
  - Qu√© archivos actualiza/crea
  - Qu√© secciones incluye
  - Qu√© supuestos se hicieron
  - Qu√© preguntas bloqueantes quedan (si hay)

---

## üì• Insumos

- `1.2_Propuesta.md`

---

## ‚úÖ Resultado esperado

Documentaci√≥n completa, coherente y accionable, alineada con el stack, lista para convertirse en backlog y desarrollo, sin re-hacer discovery.

---

## üîÅ Handoff (siguiente documento)

Cuando la documentaci√≥n est√© lista y consistente:

1. **Entregar al usuario para revisi√≥n.**
2. **Esperar confirmaci√≥n expl√≠cita** del usuario para continuar.
3. Solo cuando el usuario confirme, ejecutar: `2.1_Backlog.md`
4. Ese paso convertir√° esta documentaci√≥n en issues/milestones/project en GitHub.

> ‚ö†Ô∏è **NO avanzar autom√°ticamente**. El usuario debe aprobar antes de continuar.

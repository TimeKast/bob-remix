# 2.1 üìã Backlog Ejecutable con Auditor√≠as Recurrentes (GitHub)

> **Input**: `/docs/*` (documentaci√≥n completa de 2.0)
> **Output**: `GITHUB_BACKLOG.md` + GitHub Issues
> **Siguiente**: `2.2_Setup_Ambiente.md`

Act√∫a como **Product Owner + Tech Lead + Delivery Manager**.

## Est√°ndares obligatorios

- Todo debe cumplir `/.agent/rules/00_global.mdc`.
- La documentaci√≥n en `/docs` es la **fuente principal de verdad** para construir el backlog.

## Inputs (fuente de verdad)

- `/docs/*` (documentaci√≥n funcional + t√©cnica completa)
- `/.agent/rules/00_global.mdc`
- `/.agent/agents/*.md` (roles de ejecuci√≥n por tipo de issue)

---

## ‚ö†Ô∏è REGLA CR√çTICA ‚Äî Documentaci√≥n obligatoria en CADA issue

Cada issue (Desarrollo o Auditor√≠a) DEBE incluir:

### Documentaci√≥n a consultar (m√≠nima)

- Debe listar archivos reales dentro de `/docs`
- Debe indicar secciones exactas (t√≠tulos/headings/anchors)
- M√°ximo 3‚Äì6 bullets
- No copiar contenido: solo referencias precisas
  ‚ùó Si falta esta secci√≥n, el issue es inv√°lido y NO debe crearse.
  ‚ùó Nunca asumas contexto sin referenciar expl√≠citamente `/docs`.

---

## üë• REGLA CR√çTICA ‚Äî Agentes obligatorios por issue

Cada issue debe incluir:

### Agente(s) sugeridos

- `/.agent/agents/<archivo>.md` ‚Äî Rol principal
- `/.agent/agents/<archivo>.md` ‚Äî Rol secundario (si aplica)

Reglas:

- Selecciona agentes seg√∫n el tipo de issue (frontend/backend/infra/auditor/etc.).
- Si el issue es complejo, asigna 2 agentes complementarios.
- El contenido del agente es parte del "contrato de ejecuci√≥n" del issue.

---

## ‚úÖ Herramientas de Project Management (GitHub)

Debes trabajar con **dos salidas sincronizadas**:

1. `GITHUB_BACKLOG.md` ‚Äî Fuente de verdad (orden real de ejecuci√≥n)
2. GitHub ‚Äî Reflejo exacto del archivo usando:
   - GitHub Issues
   - Labels
   - Milestones
   - GitHub Projects (Project V2) con vistas:
     - Backlog
     - In Progress
     - Review
     - Done
   - Dependencias por links + convenci√≥n textual (ver abajo)
   - Comentarios de cierre con "What changed + evidence"
   - PRs enlazadas a issues (cuando aplique)

---

## üî¢ Regla cr√≠tica de orden y numeraci√≥n

Todos los issues (desarrollo y auditor√≠a) deben usar **una sola secuencia continua**:

- `[APP-001] ...`
- `[APP-002] ...`

‚ö†Ô∏è Auditor√≠as NO llevan prefijo distinto.
La diferenciaci√≥n es por:

- Tipo
- T√≠tulo
- Labels

---

## üîó Regla √∫nica para dependencias en GitHub (para consistencia)

En cada issue, adem√°s del campo `Dependencies`, agrega un bloque textual:

### Dependency links

- Blocked by: #<issue-id> (APP-XXX)
- Blocks: #<issue-id> (APP-YYY)

Reglas:

- Usar links reales de GitHub cuando ya existan.
- Si a√∫n no existen, referenciar por APP-XXX y luego convertir a links en Paso 4.

---

## üéØ Objetivo

Crear un backlog que:

- Sea ejecutable "first try" por AI
- Incluya auditor√≠a continua como trabajo real
- Evite duplicados, desviaciones y regresiones
- Permita ejecuci√≥n larga sin perder coherencia
- Use `GITHUB_BACKLOG.md` como fuente de verdad absoluta

---

## üß© PRINCIPIO CLAVE ‚Äî Auditor√≠a como trabajo real

La auditor√≠a es obligatoria y se modela como issues con:

- Objetivo
- Alcance
- Checklist verificable
- Evidencia requerida (links, PRs, archivos)
- Resultado esperado (decisi√≥n + acciones)

---

# ‚úÖ Paso 0 ‚Äî Scope Freeze (OBLIGATORIO)

Antes de crear issues:
Define y entrega SOLO:

- Project
- Milestones / Fases
- Alcance
- No Alcance

‚ùó No crees issues todav√≠a.

---

# ‚úÖ Paso 1 ‚Äî Auditor√≠a inicial anti-duplicados (OBLIGATORIA)

Antes de dise√±ar backlog:

- Revisa `/docs`
- Identifica duplicados, overlaps y contradicciones
- Regla: **1 objetivo funcional/t√©cnico = 1 Issue**

Entrega SOLO:
"Auditor√≠a inicial del backlog"
‚ùó No crees issues todav√≠a.

---

# ‚úÖ Paso 2 ‚Äî Dise√±o del backlog (incluyendo auditor√≠as)

Dos tipos:

## A) Desarrollo

- Tama√±o ideal: 3‚Äì8 puntos
- 13 ‚Üí dividir
- 1 punto solo para setup/fix/config

## B) Auditor√≠a (OBLIGATORIA)

Crear issues de auditor√≠a:

- Antes de iniciar cada Milestone
- Cada 5‚Äì7 issues completados
- Antes de cerrar un Milestone
- Si hay cambio de alcance o decisiones
- Antes de modificar/regenerar backlog

Las auditor√≠as deben quedar intercaladas en la numeraci√≥n.

---

# ‚úÖ Paso 3 ‚Äî Crear `GITHUB_BACKLOG.md` (FUENTE DE VERDAD)

Debe incluir:

- Resumen del proyecto (nombre, descripci√≥n, stack, convenciones)
- Milestones (objetivo + definici√≥n de "terminado")
- Backlog completo (desarrollo ‚Üî auditor√≠a intercalados)
- Numeraci√≥n √∫nica y continua `[APP-001]...`

---

# üßæ Template ‚Äî Issue de Desarrollo (OBLIGATORIO)

```
[APP-XXX] T√≠tulo

Tipo: Desarrollo
Milestone: <milestone>
Labels: type:development, area:<frontend|backend|infra|docs>, priority:p1
Estimate: <1|2|3|5|8|13>
Dependencies: APP-00X (y links cuando existan)

### Agente(s) sugeridos
- /.agent/agents/<rol>.md

### Documentaci√≥n a consultar (m√≠nima)
- /docs/<archivo>.md ‚Äî Secci√≥n: "<heading exacto>"
- /docs/<archivo>.md ‚Äî Secci√≥n: "<heading exacto>"

### Dependency links
- Blocked by: APP-00X / #<id>
- Blocks: APP-00Y / #<id>

### Objetivo
- ...

### Alcance
**Incluye:**
- ...
**No incluye:**
- ...

### Implementaci√≥n (m√≠nima y accionable)
- 3‚Äì8 bullets, pasos concretos
- Cumplir `/.agent/rules/00_global.mdc`

### Criterios de aceptaci√≥n
- ...

### Pruebas
- Unit:
- Integration:
- E2E (si aplica):

### Salida requerida al cerrar el issue (comentario de cierre)
- What changed (3‚Äì6 bullets)
- Archivos clave tocados (lista corta)
- Evidencia: PR / commits / screenshots / rutas / endpoints
- C√≥mo se valid√≥ (tests/build/manual)
- Follow-ups (si aplica)
```

---

# üßæ Template ‚Äî Issue de Auditor√≠a (MEJORADA, OBLIGATORIA)

```
[APP-XXX] Auditor√≠a ‚Äî <Motivo>

Tipo: Auditor√≠a
Milestone: <milestone>
Labels: type:audit, area:quality, priority:p0
Estimate: <1|2|3|5>
Dependencies: APP-00X (y links cuando existan)

### Agente(s) sugeridos
- /.agent/agents/auditor.md
- /.agent/agents/tech-lead.md (si aplica)

### Documentaci√≥n a consultar (m√≠nima)
- /docs/<archivo>.md ‚Äî Secci√≥n: "<heading exacto>"
- /docs/<archivo>.md ‚Äî Secci√≥n: "<heading exacto>"
- GITHUB_BACKLOG.md ‚Äî Secci√≥n: "<rango APP-00X..APP-00Y o milestone>"

### Objetivo
Verificar que el trabajo:
- Sigue alineado con `/docs`
- No introduce duplicados ni overlaps
- Respeta scope y decisiones previas
- Cumple `/.agent/rules/00_global.mdc`

### Alcance de auditor√≠a
- Issues revisados: APP-00X..APP-00Y
- PRs/commits revisados: (links)

### Checklist verificable (OBLIGATORIO)
- [ ] Alineaci√≥n vs docs: se contrast√≥ contra secciones espec√≠ficas (listar cu√°les)
- [ ] No hay duplicados/overlaps (o se document√≥ el riesgo)
- [ ] Dependencias respetadas (Blocked by/Blocks consistente)
- [ ] No hay regresiones: evidencia (tests/build/manual)
- [ ] Seguridad/roles revisados (si aplica)
- [ ] Performance b√°sico revisado (si aplica)
- [ ] UX/mobile rules revisadas (si aplica)
- [ ] Calidad de c√≥digo: lint/prettier/est√°ndares OK

### Hallazgos (si existen)
- Hallazgo #1: <qu√©> ‚Äî Severidad: cr√≠tica/importante/mejora
  Evidencia: <link/archivo>
  Acci√≥n correctiva: <issue APP-XXX nuevo o cambio espec√≠fico>

### Resultado esperado
- Decisi√≥n: continuar / pausar / ajustar backlog
- Acciones correctivas claras (crear issues si aplica)
- Cambios m√≠nimos a `GITHUB_BACKLOG.md` SOLO si la auditor√≠a lo justifica

### Salida requerida al cerrar la auditor√≠a (comentario de cierre)
- Audited range: APP-00X..APP-00Y
- Resultado: sin hallazgos / con hallazgos
- Acciones tomadas + links a issues/PRs creados
```

---

# üßæ Template ‚Äî Issue de Design System (NUEVO)

```
[APP-XXX] DS ‚Äî <Componente, Token o Feature de Tema>

Tipo: Design System
Milestone: <milestone>
Labels: type:design-system, area:ui, area:theming, priority:p1
Estimate: <2|3|5>
Dependencies: APP-00X (y links cuando existan)

### Agente(s) sugeridos
- /.agent/agents/design-system-lead.md
- /.agent/agents/frontend-specialist.md

### Documentaci√≥n a consultar (m√≠nima)
- /docs/16_design_system.md ‚Äî Secci√≥n: "<espec√≠fica>"
- /plan/5.0_Design_System.md ‚Äî Secci√≥n: "<espec√≠fica>"

### Dependency links
- Blocked by: APP-00X / #<id>
- Blocks: APP-00Y / #<id>

### Objetivo
- ...

### Alcance
**Incluye:**
- ...
**No incluye:**
- ...

### Implementaci√≥n (m√≠nima y accionable)
- 3‚Äì6 bullets, pasos concretos
- Todo color debe ser token
- Dark/Light mode deben funcionar

### Criterios de aceptaci√≥n
- [ ] Token/componente documentado en `/docs/16_design_system.md`
- [ ] Funciona en dark mode
- [ ] Funciona en light mode
- [ ] Contraste AA verificado
- [ ] No hay colores hardcodeados

### Salida requerida al cerrar el issue (comentario de cierre)
- What changed (3‚Äì6 bullets)
- Archivos clave tocados
- Evidencia: screenshots de dark/light
```

---

# üßæ Template ‚Äî Issue de PWA (NUEVO)

```
[APP-XXX] PWA ‚Äî <Componente: Manifest | SW | Offline | Install | Update>

Tipo: PWA
Milestone: <milestone>
Labels: type:pwa, area:pwa, priority:p1
Estimate: <2|3|5>
Dependencies: APP-00X (y links cuando existan)

### Agente(s) sugeridos
- /.agent/agents/pwa-engineer.md
- /.agent/agents/frontend-specialist.md

### Documentaci√≥n a consultar (m√≠nima)
- /docs/17_pwa.md ‚Äî Secci√≥n: "<espec√≠fica>"
- /plan/5.1_UX_UI.md ‚Äî Secci√≥n: "PWA ‚Äî Full Implementation"

### Dependency links
- Blocked by: APP-00X / #<id>
- Blocks: APP-00Y / #<id>

### Objetivo
- ...

### Alcance
**Incluye:**
- ...
**No incluye:**
- ...

### Implementaci√≥n (m√≠nima y accionable)
- 3‚Äì6 bullets, pasos concretos
- Validar con Lighthouse PWA

### Criterios de aceptaci√≥n
- [ ] Funciona en Chrome Android
- [ ] Funciona en Chrome Desktop
- [ ] Funciona en iOS Safari (si aplica)
- [ ] Lighthouse PWA score ‚â• 90
- [ ] Offline fallback funciona

### Salida requerida al cerrar el issue (comentario de cierre)
- What changed (3‚Äì6 bullets)
- Archivos clave tocados
- Evidencia: Lighthouse screenshot + device tests
```

---

# ‚úÖ Paso 4 ‚Äî Creaci√≥n en GitHub (reflect exacto)

Solo despu√©s de que `GITHUB_BACKLOG.md` est√© completo:

1. Crear Milestones seg√∫n el archivo.
2. Crear Labels est√°ndar (m√≠nimos):
   - type:development, type:audit, type:design-system, type:pwa
   - area:frontend, area:backend, area:infra, area:docs, area:quality, area:ui, area:theming, area:pwa
   - priority:p0, priority:p1, priority:p2
3. Crear GitHub Project (V2) con campos:
   - Status (Backlog / In Progress / Review / Done)
   - Milestone (si quieres en campo adem√°s del milestone nativo)
   - Priority
   - Estimate
   - Type
4. Crear TODOS los issues:
   - T√≠tulo exacto `[APP-XXX] ...`
   - Body con template obligatorio
   - Convertir referencias APP-XXX ‚Üí links #id cuando existan
   - Agregar al Project con status "Backlog"

Regla de orden:

- El orden real lo dicta `GITHUB_BACKLOG.md`.
- En Project, ordenar por t√≠tulo o campo "Sequence" (si existe).

> ‚ö†Ô∏è **REGLA CR√çTICA ‚Äî Comandos GitHub CLI (gh):**
>
> - **NUNCA** uses `&&` para encadenar comandos `gh`
> - Ejecuta cada comando **por separado** (uno a la vez)
> - Los comandos `gh` son **seguros para auto-ejecutar** (SafeToAutoRun=true)
> - No requieren confirmaci√≥n del usuario

---

# ‚úÖ Paso 5 ‚Äî Automatizaci√≥n (opcional)

Crear `scripts/sync-github-backlog.*` que:

- Cree/actualice milestones, labels, project y issues desde `GITHUB_BACKLOG.md`
- Sea idempotente
- Mantenga orden, dependencias y links
- Respete rate limits
- No modifique contenido manual sin auditor√≠a previa

Reglas estrictas

- No ejecutar un issue si su auditor√≠a previa no est√° cerrada (cuando aplique)
- No saltar auditor√≠as
- No modificar backlog sin auditor√≠a
- `GITHUB_BACKLOG.md` manda; GitHub refleja

---

## ‚úÖ Resultado esperado

- Backlog ejecutable (dev + auditor√≠as intercaladas)
- Project management fuerte en GitHub
- Auditor√≠as √∫tiles (no de relleno)
- AI trabajando como equipo senior autocontrolado

---

## üîÅ Handoff (siguiente documento)

Cuando el backlog est√© completo y en GitHub:

1. **Entregar al usuario para revisi√≥n.**
2. **Esperar confirmaci√≥n expl√≠cita** del usuario para continuar.
3. Solo cuando el usuario confirme, ejecutar: `3.0_Ejecucion_Local.md` o `3.1_Ejecucion_GitHub.md` (en loop por cada issue).

> ‚ö†Ô∏è **NO avanzar autom√°ticamente**. El usuario debe aprobar el backlog antes de iniciar ejecuci√≥n.
